kind: job
metadata:
  name: auto-trainer
  tag: ''
  hash: d25f46e6e845aba54ddfd8191cb1b8a5495dc457
  project: ''
  labels:
    author: yonish
  categories:
  - machine-learning
  - model-training
spec:
  command: ''
  args: []
  image: ''
  build:
    functionSourceCode: ZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QsIERpY3QsIE9wdGlvbmFsLCBVbmlvbiwgVHVwbGUsIEFueQpmcm9tIHNrbGVhcm4ubW9kZWxfc2VsZWN0aW9uIGltcG9ydCB0cmFpbl90ZXN0X3NwbGl0Cgpmcm9tIG1scnVuLmV4ZWN1dGlvbiBpbXBvcnQgTUxDbGllbnRDdHgKZnJvbSBtbHJ1bi5kYXRhc3RvcmUgaW1wb3J0IERhdGFJdGVtCmZyb20gbWxydW4uZnJhbWV3b3Jrcy5hdXRvX21scnVuIGltcG9ydCBBdXRvTUxSdW4KZnJvbSBtbHJ1biBpbXBvcnQgZmVhdHVyZV9zdG9yZSBhcyBmcwpmcm9tIG1scnVuLmFwaS5zY2hlbWFzIGltcG9ydCBPYmplY3RLaW5kCmZyb20gbWxydW4udXRpbHMuaGVscGVycyBpbXBvcnQgY3JlYXRlX2NsYXNzLCBjcmVhdGVfZnVuY3Rpb24KCgpkZWYgX3BhcnNlX2t3YXJncyhrd2FyZ3M6IERpY3QpIC0+IFR1cGxlW0RpY3QsIERpY3QsIERpY3RdOgogICAgdHJhaW5fa3csIGZpdF9rdywgbW9kZWxfY2xhc3Nfa3cgPSB7fSwge30sIHt9CgogICAgZm9yIGtleSwgdmFsIGluIGt3YXJncy5pdGVtcygpOgogICAgICAgIGlmIGtleS5zdGFydHN3aXRoKCJUUkFJTl8iKToKICAgICAgICAgICAgdHJhaW5fa3dba2V5LnJlcGxhY2UoIlRSQUlOXyIsICIiKV0gPSB2YWwKCiAgICAgICAgZWxpZiBrZXkuc3RhcnRzd2l0aCgiRklUXyIpOgogICAgICAgICAgICB0cmFpbl9rd1trZXkucmVwbGFjZSgiRklUXyIsICIiKV0gPSB2YWwKCiAgICAgICAgZWxpZiBrZXkuc3RhcnRzd2l0aCgiTU9ERUxfQ0xBU1NfIik6CiAgICAgICAgICAgIG1vZGVsX2NsYXNzX2t3W2tleS5yZXBsYWNlKCJNT0RFTF9DTEFTU18iLCAiIildID0gdmFsCgogICAgcmV0dXJuIHRyYWluX2t3LCBmaXRfa3csIG1vZGVsX2NsYXNzX2t3CgoKZGVmIHRyYWluKAogICAgY29udGV4dDogTUxDbGllbnRDdHgsCiAgICBkYXRhc2V0OiBEYXRhSXRlbSwKICAgIGRyb3BfY29sdW1uczogTGlzdFtzdHJdID0gTm9uZSwKICAgIG1vZGVsX2NsYXNzOiBzdHIgPSBOb25lLAogICAgbW9kZWxfbmFtZTogc3RyID0gIm1vZGVsIiwKICAgIHRhZzogc3RyID0gIiIsCiAgICBsYWJlbF9jb2x1bW5zOiBPcHRpb25hbFtVbmlvbltzdHIsIExpc3Rbc3RyXV1dID0gTm9uZSwKICAgIHNhbXBsZV9zZXQ6IERhdGFJdGVtID0gTm9uZSwKICAgIHRlc3Rfc2V0OiBEYXRhSXRlbSA9IE5vbmUsCiAgICB0cmFpbl90ZXN0X3NwbGl0X3NpemU6IGZsb2F0ID0gTm9uZSwKICAgIGFydGlmYWN0czogRGljdCA9IE5vbmUsCiAgICBrd2FyZ3M6IERpY3Rbc3RyLCBBbnldID0gTm9uZSwKKToKICAgICMgVmFsaWRhdGUgaW5wdXRzOgogICAgIyBDaGVjayBpZiBvbmx5IG9uZSBvZiB0aGVtIGlzIHN1cHBsaWVkOgogICAgaWYgKHRlc3Rfc2V0IGlzIE5vbmUpID09ICh0cmFpbl90ZXN0X3NwbGl0X3NpemUgaXMgTm9uZSk6CiAgICAgICAgcmFpc2UgVHlwZUVycm9yKAogICAgICAgICAgICBmIlByb3ZpZGUgb25seSBvbmUgb2YgdGVzdF9zZXQgbW9kZWwgYW5kIHRyYWluX3Rlc3Rfc3BsaXRfc2l6ZSIKICAgICAgICApCgogICAgaWYgZGF0YXNldC5tZXRhIGFuZCBkYXRhc2V0Lm1ldGEua2luZCA9PSBPYmplY3RLaW5kLmZlYXR1cmVfdmVjdG9yOgogICAgICAgICMgZmVhdHVyZS12ZWN0b3IgY2FzZToKICAgICAgICBkYXRhc2V0ID0gZnMuZ2V0X29mZmxpbmVfZmVhdHVyZXMoZGF0YXNldC5tZXRhLnVyaSwgZHJvcF9jb2x1bW5zPWRyb3BfY29sdW1ucykudG9fZGF0YWZyYW1lKCkKICAgICAgICBsYWJlbF9jb2x1bW5zID0gbGFiZWxfY29sdW1ucyBvciBkYXRhc2V0Lm1ldGEuc3RhdHVzLmxhYmVsX2NvbHVtbgogICAgZWxzZToKICAgICAgICAjIHNpbXBsZSBVUkwgY2FzZToKICAgICAgICBkYXRhc2V0ID0gZGF0YXNldC5hc19kZigpCiAgICAgICAgaWYgZHJvcF9jb2x1bW5zOgogICAgICAgICAgICBkYXRhc2V0ID0gZGF0YXNldC5kcm9wKGRyb3BfY29sdW1ucywgYXhpcz0xKQoKICAgICMgUGFyc2luZyBrd2FyZ3M6CiAgICB0cmFpbl9rdywgZml0X2t3LCBtb2RlbF9jbGFzc19rdyA9IF9wYXJzZV9rd2FyZ3Moa3dhcmdzKQoKICAgICMgQ2hlY2sgaWYgbW9kZWwgb3IgZnVuY3Rpb246CiAgICBpZiBoYXNhdHRyKG1vZGVsX2NsYXNzLCAndHJhaW4nKToKICAgICAgICAjIFRPRE86IE5lZWQgdG8gY2FsbDogbW9kZWwoKSwgYWZ0ZXJ3YXJkcyB0byBzdGFydCB0aGUgdHJhaW4gZnVuY3Rpb24uCiAgICAgICAgbW9kZWwgPSBjcmVhdGVfZnVuY3Rpb24oZid7bW9kZWxfY2xhc3N9LnRyYWluJykKICAgIGVsc2U6CiAgICAgICAgIyBDcmVhdGluZyBtb2RlbCBpbnN0YW5jZToKICAgICAgICBtb2RlbCA9IGNyZWF0ZV9jbGFzcyhtb2RlbF9jbGFzcykoKiptb2RlbF9jbGFzc19rdykKCiAgICB4ID0gZGF0YXNldC5kcm9wKGxhYmVsX2NvbHVtbnMsIGF4aXM9MSkKICAgIHkgPSBkYXRhc2V0W2xhYmVsX2NvbHVtbnNdCiAgICBpZiB0cmFpbl90ZXN0X3NwbGl0X3NpemU6CiAgICAgICAgeF90cmFpbiwgeF90ZXN0LCB5X3RyYWluLCB5X3Rlc3QgPSB0cmFpbl90ZXN0X3NwbGl0KAogICAgICAgICAgICB4LCB5LCB0ZXN0X3NpemU9dHJhaW5fdGVzdF9zcGxpdF9zaXplCiAgICAgICAgKQogICAgZWxzZToKICAgICAgICB4X3RyYWluLCB5X3RyYWluID0geCwgeQoKICAgICAgICB0ZXN0X3NldCA9IHRlc3Rfc2V0LmFzX2RmKCkKICAgICAgICBpZiBkcm9wX2NvbHVtbnM6CiAgICAgICAgICAgIHRlc3Rfc2V0ID0gZGF0YXNldC5kcm9wKGRyb3BfY29sdW1ucywgYXhpcz0xKQoKICAgICAgICB4X3Rlc3QsIHlfdGVzdCA9IHRlc3Rfc2V0LmRyb3AobGFiZWxfY29sdW1ucywgYXhpcz0xKSwgdGVzdF9zZXRbbGFiZWxfY29sdW1uc10KCiAgICBBdXRvTUxSdW4uYXBwbHlfbWxydW4oCiAgICAgICAgbW9kZWw9bW9kZWwsCiAgICAgICAgbW9kZWxfbmFtZT1tb2RlbF9uYW1lLAogICAgICAgIGNvbnRleHQ9Y29udGV4dCwKICAgICAgICB0YWc9dGFnLAogICAgICAgIHNhbXBsZV9zZXQ9c2FtcGxlX3NldCwKICAgICAgICB0ZXN0X3NldD10ZXN0X3NldCwKICAgICAgICBYX3Rlc3Q9eF90ZXN0LAogICAgICAgIHlfdGVzdD15X3Rlc3QsCiAgICAgICAgYXJ0aWZhY3RzPWFydGlmYWN0cywKICAgICkKCiAgICBtb2RlbC5maXQoeF90cmFpbiwgeV90cmFpbiwgKipmaXRfa3cpCg==
    commands: []
    code_origin: https://github.com/mlrun/functions.git#0d491653d71a31d17aa5f6b42e79e5af3de26aa9:C:\Users\yonatans\projects\functions\auto_trainer\auto_trainer.py
    origin_filename: C:\Users\yonatans\projects\functions\auto_trainer\auto_trainer.py
  entry_points:
    train:
      name: train
      doc: ''
      parameters:
      - name: context
        type: MLClientCtx
        default: ''
      - name: dataset
        type: DataItem
        default: ''
      - name: drop_columns
        type: List[str]
        default: null
      - name: model_class
        type: str
        default: null
      - name: model_name
        type: str
        default: model
      - name: tag
        type: str
        default: ''
      - name: label_columns
        type: Optional[Union[str, List[str]]]
        default: null
      - name: sample_set
        type: DataItem
        default: null
      - name: test_set
        type: DataItem
        default: null
      - name: train_test_split_size
        type: float
        default: null
      - name: artifacts
        type: Dict
        default: null
      - name: kwargs
        type: Dict[str, Any]
        default: null
      outputs:
      - default: ''
      lineno: 28
  description: ''
  default_handler: train
  disable_auto_mount: false
  env: []
  priority_class_name: ''
  affinity: null
verbose: false
