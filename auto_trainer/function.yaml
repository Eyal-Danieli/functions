kind: job
metadata:
  name: auto-trainer
  tag: ''
  hash: db2f603bb4a1988f95aa74c7fe01a82642c582c9
  project: ''
  labels:
    author: yonish
  categories:
  - machine-learning
  - model-training
spec:
  command: ''
  args: []
  image: ''
  build:
    functionSourceCode: ZnJvbSB0eXBpbmcgaW1wb3J0IExpc3QsIERpY3QsIE9wdGlvbmFsLCBVbmlvbiwgVHVwbGUsIEFueQpmcm9tIGNsb3VkcGlja2xlIGltcG9ydCBkdW1wcwpmcm9tIHNrbGVhcm4ubW9kZWxfc2VsZWN0aW9uIGltcG9ydCB0cmFpbl90ZXN0X3NwbGl0Cgpmcm9tIG1scnVuLmV4ZWN1dGlvbiBpbXBvcnQgTUxDbGllbnRDdHgKZnJvbSBtbHJ1bi5kYXRhc3RvcmUgaW1wb3J0IERhdGFJdGVtCmZyb20gbWxydW4uZnJhbWV3b3Jrcy5hdXRvX21scnVuIGltcG9ydCBBdXRvTUxSdW4KZnJvbSBtbHJ1biBpbXBvcnQgZmVhdHVyZV9zdG9yZSBhcyBmcwpmcm9tIG1scnVuLmFwaS5zY2hlbWFzIGltcG9ydCBPYmplY3RLaW5kCmZyb20gbWxydW4udXRpbHMuaGVscGVycyBpbXBvcnQgY3JlYXRlX2NsYXNzLCBjcmVhdGVfZnVuY3Rpb24KCgpjbGFzcyBLV0FyZ3NQcmVmaXhlczoKICAgIE1PREVMX0NMQVNTID0gIkNMQVNTXyIKICAgIEZJVCA9ICJGSVRfIgogICAgVFJBSU4gPSAiVFJBSU5fIgoKCmRlZiBfcGFyc2Vfa3dhcmdzKAogICAga3dhcmdzOiBEaWN0LAopIC0+IFR1cGxlW0RpY3Rbc3RyLCBBbnldLCBEaWN0W3N0ciwgQW55XSwgRGljdFtzdHIsIEFueV1dOgogICAgdHJhaW5fa3csIGZpdF9rdywgbW9kZWxfY2xhc3Nfa3cgPSB7fSwge30sIHt9CgogICAgZm9yIGtleSwgdmFsIGluIGt3YXJncy5pdGVtcygpOgogICAgICAgIGlmIGtleS5zdGFydHN3aXRoKEtXQXJnc1ByZWZpeGVzLlRSQUlOKToKICAgICAgICAgICAgdHJhaW5fa3dba2V5LnJlcGxhY2UoS1dBcmdzUHJlZml4ZXMuVFJBSU4sICIiKV0gPSB2YWwKCiAgICAgICAgZWxpZiBrZXkuc3RhcnRzd2l0aChLV0FyZ3NQcmVmaXhlcy5GSVQpOgogICAgICAgICAgICBmaXRfa3dba2V5LnJlcGxhY2UoS1dBcmdzUHJlZml4ZXMuRklULCAiIildID0gdmFsCgogICAgICAgIGVsaWYga2V5LnN0YXJ0c3dpdGgoS1dBcmdzUHJlZml4ZXMuTU9ERUxfQ0xBU1MpOgogICAgICAgICAgICBtb2RlbF9jbGFzc19rd1trZXkucmVwbGFjZShLV0FyZ3NQcmVmaXhlcy5NT0RFTF9DTEFTUywgIiIpXSA9IHZhbAoKICAgIHJldHVybiB0cmFpbl9rdywgZml0X2t3LCBtb2RlbF9jbGFzc19rdwoKCmRlZiB0cmFpbigKICAgIGNvbnRleHQ6IE1MQ2xpZW50Q3R4LAogICAgZGF0YXNldDogRGF0YUl0ZW0sCiAgICBkcm9wX2NvbHVtbnM6IExpc3Rbc3RyXSA9IE5vbmUsCiAgICBtb2RlbF9jbGFzczogc3RyID0gTm9uZSwKICAgIG1vZGVsX25hbWU6IHN0ciA9ICJtb2RlbCIsCiAgICB0YWc6IHN0ciA9ICIiLAogICAgbGFiZWxfY29sdW1uczogT3B0aW9uYWxbVW5pb25bc3RyLCBMaXN0W3N0cl1dXSA9IE5vbmUsCiAgICBzYW1wbGVfc2V0OiBEYXRhSXRlbSA9IE5vbmUsCiAgICB0ZXN0X3NldDogRGF0YUl0ZW0gPSBOb25lLAogICAgdHJhaW5fdGVzdF9zcGxpdF9zaXplOiBmbG9hdCA9IE5vbmUsCik6CiAgICAjIFZhbGlkYXRlIGlucHV0czoKICAgICMgQ2hlY2sgaWYgb25seSBvbmUgb2YgdGhlbSBpcyBzdXBwbGllZDoKICAgIGlmICh0ZXN0X3NldCBpcyBOb25lKSA9PSAodHJhaW5fdGVzdF9zcGxpdF9zaXplIGlzIE5vbmUpOgogICAgICAgIHJhaXNlIFR5cGVFcnJvcihmIlByb3ZpZGUgb25seSBvbmUgb2YgdGVzdF9zZXQgbW9kZWwgYW5kIHRyYWluX3Rlc3Rfc3BsaXRfc2l6ZSIpCgogICAgaWYgZGF0YXNldC5tZXRhIGFuZCBkYXRhc2V0Lm1ldGEua2luZCA9PSBPYmplY3RLaW5kLmZlYXR1cmVfdmVjdG9yOgogICAgICAgICMgZmVhdHVyZS12ZWN0b3IgY2FzZToKICAgICAgICBkYXRhc2V0ID0gZnMuZ2V0X29mZmxpbmVfZmVhdHVyZXMoCiAgICAgICAgICAgIGRhdGFzZXQubWV0YS51cmksIGRyb3BfY29sdW1ucz1kcm9wX2NvbHVtbnMKICAgICAgICApLnRvX2RhdGFmcmFtZSgpCiAgICAgICAgbGFiZWxfY29sdW1ucyA9IGxhYmVsX2NvbHVtbnMgb3IgZGF0YXNldC5tZXRhLnN0YXR1cy5sYWJlbF9jb2x1bW4KICAgICAgICBjb250ZXh0LmxvZ2dlci5pbmZvKGYibGFiZWwgY29sdW1uczoge2xhYmVsX2NvbHVtbnN9IikKICAgIGVsc2U6CiAgICAgICAgIyBzaW1wbGUgVVJMIGNhc2U6CiAgICAgICAgZGF0YXNldCA9IGRhdGFzZXQuYXNfZGYoKQogICAgICAgIGlmIGRyb3BfY29sdW1uczoKICAgICAgICAgICAgZGF0YXNldCA9IGRhdGFzZXQuZHJvcChkcm9wX2NvbHVtbnMsIGF4aXM9MSkKCiAgICAjIFBhcnNpbmcga3dhcmdzOgogICAgdHJhaW5fa3csIGZpdF9rdywgbW9kZWxfY2xhc3Nfa3cgPSBfcGFyc2Vfa3dhcmdzKGNvbnRleHQucGFyYW1ldGVycykKCiAgICAjIENoZWNrIGlmIG1vZGVsIG9yIGZ1bmN0aW9uOgogICAgaWYgaGFzYXR0cihtb2RlbF9jbGFzcywgInRyYWluIik6CiAgICAgICAgIyBUT0RPOiBOZWVkIHRvIGNhbGw6IG1vZGVsKCksIGFmdGVyd2FyZHMgdG8gc3RhcnQgdGhlIHRyYWluIGZ1bmN0aW9uLgogICAgICAgIG1vZGVsID0gY3JlYXRlX2Z1bmN0aW9uKGYie21vZGVsX2NsYXNzfS50cmFpbiIpCiAgICBlbHNlOgogICAgICAgICMgQ3JlYXRpbmcgbW9kZWwgaW5zdGFuY2U6CiAgICAgICAgbW9kZWwgPSBjcmVhdGVfY2xhc3MobW9kZWxfY2xhc3MpKCoqbW9kZWxfY2xhc3Nfa3cpCgogICAgeCA9IGRhdGFzZXQuZHJvcChsYWJlbF9jb2x1bW5zLCBheGlzPTEpCiAgICB5ID0gZGF0YXNldFtsYWJlbF9jb2x1bW5zXQogICAgaWYgdHJhaW5fdGVzdF9zcGxpdF9zaXplOgogICAgICAgIHhfdHJhaW4sIHhfdGVzdCwgeV90cmFpbiwgeV90ZXN0ID0gdHJhaW5fdGVzdF9zcGxpdCgKICAgICAgICAgICAgeCwgeSwgdGVzdF9zaXplPXRyYWluX3Rlc3Rfc3BsaXRfc2l6ZQogICAgICAgICkKICAgIGVsc2U6CiAgICAgICAgeF90cmFpbiwgeV90cmFpbiA9IHgsIHkKCiAgICAgICAgdGVzdF9zZXQgPSB0ZXN0X3NldC5hc19kZigpCiAgICAgICAgaWYgZHJvcF9jb2x1bW5zOgogICAgICAgICAgICB0ZXN0X3NldCA9IGRhdGFzZXQuZHJvcChkcm9wX2NvbHVtbnMsIGF4aXM9MSkKCiAgICAgICAgeF90ZXN0LCB5X3Rlc3QgPSB0ZXN0X3NldC5kcm9wKGxhYmVsX2NvbHVtbnMsIGF4aXM9MSksIHRlc3Rfc2V0W2xhYmVsX2NvbHVtbnNdCgogICAgQXV0b01MUnVuLmFwcGx5X21scnVuKAogICAgICAgIG1vZGVsPW1vZGVsLAogICAgICAgIG1vZGVsX25hbWU9bW9kZWxfbmFtZSwKICAgICAgICBjb250ZXh0PWNvbnRleHQsCiAgICAgICAgdGFnPXRhZywKICAgICAgICBzYW1wbGVfc2V0PXNhbXBsZV9zZXQsCiAgICAgICAgdGVzdF9zZXQ9dGVzdF9zZXQsCiAgICAgICAgWF90ZXN0PXhfdGVzdCwKICAgICAgICB5X3Rlc3Q9eV90ZXN0LAogICAgICAgIGFydGlmYWN0cz1jb250ZXh0LmFydGlmYWN0cywKICAgICkKICAgIGNvbnRleHQubG9nZ2VyLmluZm8oZid0cmFpbmluZyBtb2RlbCA9IHttb2RlbF9uYW1lfScpCiAgICBtb2RlbCA9IG1vZGVsLmZpdCh4X3RyYWluLCB5X3RyYWluLCAqKmZpdF9rdykKICAgIHBhc3MKCgojIGRlZiBldmFsdWF0ZSgKIyAgICAgY29udGV4dDogTUxDbGllbnRDdHgsCiMgKToKIyAgICAgcGFzcwojCiMKIyBkZWYgcHJlZGljdCgpOgojICAgICBwYXNzCg==
    commands: []
    code_origin: https://github.com/mlrun/functions.git#6027574385cfc7fa131aa0aa2c64aacf8c304e77:C:\Users\yonatans\projects\functions\auto_trainer\auto_trainer.py
    origin_filename: C:\Users\yonatans\projects\functions\auto_trainer\auto_trainer.py
  entry_points:
    train:
      name: train
      doc: ''
      parameters:
      - name: context
        type: MLClientCtx
        default: ''
      - name: dataset
        type: DataItem
        default: ''
      - name: drop_columns
        type: List[str]
        default: null
      - name: model_class
        type: str
        default: null
      - name: model_name
        type: str
        default: model
      - name: tag
        type: str
        default: ''
      - name: label_columns
        type: Optional[Union[str, List[str]]]
        default: null
      - name: sample_set
        type: DataItem
        default: null
      - name: test_set
        type: DataItem
        default: null
      - name: train_test_split_size
        type: float
        default: null
      outputs:
      - default: ''
      lineno: 37
  description: ''
  default_handler: train
  disable_auto_mount: false
  env: []
  priority_class_name: ''
  affinity: null
verbose: false
